{"ast":null,"code":"import { UntypedFormControl, UntypedFormGroup, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/categories.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction GestionCategorieComponent_div_2_tr_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\")(8, \"button\", 3);\n    i0.ɵɵlistener(\"click\", function GestionCategorieComponent_div_2_tr_11_Template_button_click_8_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const categorie_r4 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r5.onEdit(categorie_r4.id_catetgorie));\n    });\n    i0.ɵɵtext(9, \"Edit\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const categorie_r4 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(categorie_r4.libelle);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(categorie_r4.bareme);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(categorie_r4.nb_question);\n  }\n}\nfunction GestionCategorieComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"table\")(2, \"thead\")(3, \"tr\")(4, \"th\");\n    i0.ɵɵtext(5, \"Libelle\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"th\");\n    i0.ɵɵtext(7, \"Bareme\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"th\");\n    i0.ɵɵtext(9, \"NbQuestion\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(10, \"tbody\");\n    i0.ɵɵtemplate(11, GestionCategorieComponent_div_2_tr_11_Template, 10, 3, \"tr\", 2);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(11);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.categories);\n  }\n}\nfunction GestionCategorieComponent_form_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"form\", 4);\n    i0.ɵɵlistener(\"ngSubmit\", function GestionCategorieComponent_form_3_Template_form_ngSubmit_0_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.updateCategorie());\n    });\n    i0.ɵɵelement(1, \"input\", 5)(2, \"input\", 6)(3, \"input\", 7);\n    i0.ɵɵelementStart(4, \"button\", 8);\n    i0.ɵɵtext(5, \"Edit\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r1.form);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"value\", ctx_r1.current.libelle);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"value\", ctx_r1.current.bareme);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"value\", ctx_r1.current.nb_question);\n  }\n}\nfunction GestionCategorieComponent_form_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"form\", 4);\n    i0.ɵɵlistener(\"ngSubmit\", function GestionCategorieComponent_form_4_Template_form_ngSubmit_0_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.addCategorie());\n    });\n    i0.ɵɵelement(1, \"input\", 9)(2, \"input\", 10)(3, \"input\", 11);\n    i0.ɵɵelementStart(4, \"button\", 8);\n    i0.ɵɵtext(5, \"Ajouter\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r2.form);\n  }\n}\nexport let GestionCategorieComponent = /*#__PURE__*/(() => {\n  class GestionCategorieComponent {\n    constructor(categoriesService, route) {\n      this.categoriesService = categoriesService;\n      this.route = route;\n      this.categories = [];\n      this.loading = false;\n      this.form = new UntypedFormGroup({\n        libelle: new UntypedFormControl('', [Validators.required, Validators.max(100)]),\n        bareme: new UntypedFormControl('', [Validators.required, Validators.min(1), Validators.max(25)]),\n        nb_questions: new UntypedFormControl('', [Validators.required, Validators.min(2), Validators.max(50)])\n      });\n      this.edit = false;\n      this.id = 0;\n      this.current = null;\n    }\n    ngOnInit() {\n      this.loading = true;\n      this.categoriesService.getAllCategories().subscribe(categories => {\n        this.categories = categories;\n        this.loading = false;\n      });\n    }\n    addCategorie() {\n      if (this.form.valid) {\n        const val = this.form.value;\n        const categorie = this.categoriesService.addCategorie({\n          id_catetgorie: this.categories.length,\n          libelle: val.libelle,\n          bareme: val.bareme,\n          nb_question: val.nb_questions\n        });\n        this.categories.push(categorie);\n      }\n    }\n    updateCategorie() {\n      if (this.form.valid) {\n        const val = this.form.value;\n        const categorie = this.categoriesService.updateCategorie(this.id, {\n          id_catetgorie: this.id,\n          libelle: val.libelle,\n          bareme: val.bareme,\n          nb_question: val.nb_questions\n        });\n        this.edit = false;\n        const i = this.findCategorie(this.id);\n        this.categories[i].libelle = categorie.libelle;\n        this.categories[i].bareme = categorie.bareme;\n        this.categories[i].nb_question = categorie.nb_question;\n      }\n    }\n    onEdit(id) {\n      this.id = id;\n      this.current = this.categories[this.findCategorie(id)];\n      console.log(this.current);\n      this.edit = true;\n    }\n    findCategorie(id) {\n      for (let i = 1; i < this.categories.length; i++) {\n        if (this.categories[i].id_catetgorie === id) {\n          return i;\n        }\n      }\n      return -1;\n    }\n  }\n  GestionCategorieComponent.ɵfac = function GestionCategorieComponent_Factory(t) {\n    return new (t || GestionCategorieComponent)(i0.ɵɵdirectiveInject(i1.CategoriesService), i0.ɵɵdirectiveInject(i2.ActivatedRoute));\n  };\n  GestionCategorieComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: GestionCategorieComponent,\n    selectors: [[\"app-gestion-categorie\"]],\n    decls: 5,\n    vars: 3,\n    consts: [[4, \"ngIf\"], [3, \"formGroup\", \"ngSubmit\", 4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"], [3, \"click\"], [3, \"formGroup\", \"ngSubmit\"], [\"type\", \"text\", \"formControlName\", \"libelle\", 3, \"value\"], [\"type\", \"number\", \"formControlName\", \"bareme\", 3, \"value\"], [\"type\", \"number\", \"formControlName\", \"nb_questions\", 3, \"value\"], [\"type\", \"submit\"], [\"type\", \"text\", \"formControlName\", \"libelle\"], [\"type\", \"number\", \"formControlName\", \"bareme\"], [\"type\", \"number\", \"formControlName\", \"nb_questions\"]],\n    template: function GestionCategorieComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"p\");\n        i0.ɵɵtext(1, \"gestion-categorie works!\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(2, GestionCategorieComponent_div_2_Template, 12, 1, \"div\", 0);\n        i0.ɵɵtemplate(3, GestionCategorieComponent_form_3_Template, 6, 4, \"form\", 1);\n        i0.ɵɵtemplate(4, GestionCategorieComponent_form_4_Template, 6, 1, \"form\", 1);\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", !ctx.loading);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.edit);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.edit);\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf, i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.NumberValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.FormGroupDirective, i4.FormControlName]\n  });\n  return GestionCategorieComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}